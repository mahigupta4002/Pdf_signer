{% extends "base.html" %}
{% block content %}
<div class="container">
  <h2 class="mb-4">Welcome, {{ username }}</h2>
  <p>
    <a href="{{ url_for('upload') }}" class="btn btn-primary">Upload New PDF</a>
    <a href="{{ url_for('logout') }}" class="btn btn-secondary">Logout</a>
  </p>

  <h3>Your Requests</h3>
  <table class="table table-bordered">
    <thead class="table-dark">
      <tr><th>ID</th><th>PDF</th><th>Status</th><th>Signed</th></tr>
    </thead>
    <tbody>
      {% for r in requests %}
      <tr>
        <td>{{ r["id"] }}</td>
        <td>{{ r["pdf_path"].split('/')[-1] }}</td>
        <td>
          {% if r["status"] == "pending" %}<span class="badge bg-warning">Pending</span>
          {% elif r["status"] == "approved" %}<span class="badge bg-success">Approved</span>
          {% elif r["status"] == "rejected" %}<span class="badge bg-danger">Rejected</span>
          {% endif %}
        </td>
        <td>
          {% if r["status"] == "approved" and r["signed_path"] %}
            <a href="{{ url_for('download_file', req_id=r['id']) }}" class="btn btn-sm btn-primary">Download</a>
          {% else %}-{% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
